/media/pc3048/8e92fcae-9dcb-48b7-818b-82c5f8ed050e/aidata/tjk/05-mySync/og-lans/evaluate.py:915: UserWarning: WARNING: Unsloth should be imported before [transformers] to ensure all optimizations are applied. Your code may run slower or encounter memory issues without these optimizations.

Please restructure your imports with 'import unsloth' at the top of your file.
  from unsloth import FastLanguageModel
ğŸ¦¥ Unsloth: Will patch your computer to enable 2x faster free finetuning.
âš™ï¸  Running in WANDB offline mode
ğŸ¦¥ Unsloth Zoo will now patch everything to make training faster!
ğŸ“Š æ•°æ®é›†: DuEE-Fin | åˆ’åˆ†: dev
ğŸ“‚ Schema: ./data/raw/DuEE-Fin/duee_fin_event_schema.json
ğŸ†” Run ID: 20260215_001756_dev_seed3407_p1353069
ğŸ’¾ ç»“æœä¿å­˜è‡³: logs/DuEE-Fin/eval_academic/20260215_001745_dev/eval_results_dev_seed3407.jsonl
ğŸ“œ Protocol: configs/eval_protocol.yaml
ğŸ¯ Primary Metric: strict_f1
ğŸ§­ Canonical Metric Mode: analysis_only

ğŸ”„ åŠ è½½æ¨¡å‹...
2026-02-15 00:17:56,718 - modelscope - INFO - PyTorch version 2.6.0+cu118 Found.
2026-02-15 00:17:56,719 - modelscope - INFO - Loading ast index from /home/pc3048/.cache/modelscope/ast_indexer
2026-02-15 00:17:56,748 - modelscope - INFO - Loading done! Current index file version is 1.13.0, with md5 836ec9fa04cf4276bd35d82776b63d0a and a total number of 972 components indexed
2026-02-15 00:17:56,750 - modelscope - WARNING - Authentication has expired, please re-login if you need to access private models or datasets.
==((====))==  Unsloth 2026.1.4: Fast Qwen3 patching. Transformers: 4.57.6.
   \\   /|    NVIDIA RTX A6000. Num GPUs = 1. Max memory: 47.528 GB. Platform: Linux.
O^O/ \_/ \    Torch: 2.6.0+cu118. CUDA: 8.6. CUDA Toolkit: 11.8. Triton: 3.2.0
\        /    Bfloat16 = TRUE. FA [Xformers = None. FA2 = True]
 "-____-"     Free license: http://github.com/unslothai/unsloth
Unsloth: Fast downloading is enabled - ignore downloading bars which are red colored!
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|â–ˆâ–ˆâ–ˆâ–      | 1/3 [00:04<00:08,  4.02s/it]Loading checkpoint shards:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:08<00:04,  4.27s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:08<00:00,  2.38s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:08<00:00,  2.86s/it]
â„¹ï¸ æ£€æµ‹åˆ°é‡åŒ–æ¨¡å‹ï¼Œè·³è¿‡ model.to(device)ï¼ˆç”± from_pretrained è‡ªåŠ¨æ”¾ç½®è®¾å¤‡ï¼‰ã€‚
ğŸ–¥ï¸ æ¨ç†è®¾å¤‡: cuda
ğŸ”§ EOS Token: <|im_end|> | EOS Token ID: 151645

ğŸ“š åŠ è½½æ•°æ®...
   åŠ è½½ 1171 æ¡æ ·æœ¬

ğŸš€ å¼€å§‹æ¨ç† (Batch Size: 16, è§£ç ç­–ç•¥: ç¡®å®šæ€§è§£ç  (Greedy))...
è¯„ä¼°è¿›åº¦:   0%|          | 0/74 [00:00<?, ?it/s]/media/pc3048/8e92fcae-9dcb-48b7-818b-82c5f8ed050e/software/anaconda3/envs/tjk_ee/lib/python3.10/site-packages/unsloth/kernels/utils.py:970: UserWarning: An output with one or more elements was resized since it had shape [1, 16, 2560], which does not match the required output shape [16, 1, 2560]. This behavior is deprecated, and in a future PyTorch release outputs will not be resized unless they have zero elements. You can explicitly reuse an out tensor t by resizing it, inplace, to zero elements with t.resize_(0). (Triggered internally at /pytorch/aten/src/ATen/native/Resize.cpp:30.)
  out = torch_matmul(X, W, out = out)
è¯„ä¼°è¿›åº¦:   1%|â–         | 1/74 [02:15<2:45:05, 135.70s/it]è¯„ä¼°è¿›åº¦:   3%|â–         | 2/74 [04:28<2:40:40, 133.89s/it]è¯„ä¼°è¿›åº¦:   4%|â–         | 3/74 [06:37<2:36:02, 131.86s/it]è¯„ä¼°è¿›åº¦:   5%|â–Œ         | 4/74 [08:31<2:25:37, 124.82s/it]è¯„ä¼°è¿›åº¦:   7%|â–‹         | 5/74 [10:22<2:17:29, 119.56s/it]è¯„ä¼°è¿›åº¦:   8%|â–Š         | 6/74 [12:52<2:27:30, 130.15s/it]è¯„ä¼°è¿›åº¦:   9%|â–‰         | 7/74 [14:43<2:18:21, 123.90s/it]è¯„ä¼°è¿›åº¦:  11%|â–ˆ         | 8/74 [16:56<2:19:15, 126.60s/it]è¯„ä¼°è¿›åº¦:  12%|â–ˆâ–        | 9/74 [19:15<2:21:37, 130.74s/it]è¯„ä¼°è¿›åº¦:  14%|â–ˆâ–        | 10/74 [22:25<2:38:56, 149.01s/it]è¯„ä¼°è¿›åº¦:  15%|â–ˆâ–        | 11/74 [25:25<2:46:23, 158.47s/it]è¯„ä¼°è¿›åº¦:  16%|â–ˆâ–Œ        | 12/74 [27:44<2:37:23, 152.32s/it]è¯„ä¼°è¿›åº¦:  18%|â–ˆâ–Š        | 13/74 [29:50<2:26:51, 144.45s/it]è¯„ä¼°è¿›åº¦:  19%|â–ˆâ–‰        | 14/74 [33:07<2:40:15, 160.26s/it]è¯„ä¼°è¿›åº¦:  20%|â–ˆâ–ˆ        | 15/74 [35:19<2:29:21, 151.89s/it]/media/pc3048/8e92fcae-9dcb-48b7-818b-82c5f8ed050e/software/anaconda3/envs/tjk_ee/lib/python3.10/site-packages/unsloth/kernels/utils.py:970: UserWarning: An output with one or more elements was resized since it had shape [1, 16, 2560], which does not match the required output shape [16, 1, 2560]. This behavior is deprecated, and in a future PyTorch release outputs will not be resized unless they have zero elements. You can explicitly reuse an out tensor t by resizing it, inplace, to zero elements with t.resize_(0). (Triggered internally at /pytorch/aten/src/ATen/native/Resize.cpp:30.)
  out = torch_matmul(X, W, out = out)
è¯„ä¼°è¿›åº¦:  22%|â–ˆâ–ˆâ–       | 16/74 [38:38<2:40:24, 165.94s/it]è¯„ä¼°è¿›åº¦:  23%|â–ˆâ–ˆâ–       | 17/74 [41:55<2:46:42, 175.48s/it]è¯„ä¼°è¿›åº¦:  24%|â–ˆâ–ˆâ–       | 18/74 [43:43<2:24:41, 155.02s/it]è¯„ä¼°è¿›åº¦:  26%|â–ˆâ–ˆâ–Œ       | 19/74 [46:37<2:27:17, 160.68s/it]è¯„ä¼°è¿›åº¦:  27%|â–ˆâ–ˆâ–‹       | 20/74 [48:25<2:10:35, 145.10s/it]è¯„ä¼°è¿›åº¦:  28%|â–ˆâ–ˆâ–Š       | 21/74 [50:43<2:06:07, 142.78s/it]è¯„ä¼°è¿›åº¦:  30%|â–ˆâ–ˆâ–‰       | 22/74 [52:24<1:52:49, 130.18s/it]è¯„ä¼°è¿›åº¦:  31%|â–ˆâ–ˆâ–ˆ       | 23/74 [54:24<1:48:07, 127.20s/it]è¯„ä¼°è¿›åº¦:  32%|â–ˆâ–ˆâ–ˆâ–      | 24/74 [56:16<1:42:15, 122.71s/it]è¯„ä¼°è¿›åº¦:  34%|â–ˆâ–ˆâ–ˆâ–      | 25/74 [58:15<1:39:12, 121.49s/it]è¯„ä¼°è¿›åº¦:  35%|â–ˆâ–ˆâ–ˆâ–Œ      | 26/74 [1:01:34<1:55:45, 144.70s/it]è¯„ä¼°è¿›åº¦:  36%|â–ˆâ–ˆâ–ˆâ–‹      | 27/74 [1:03:45<1:50:08, 140.60s/it]è¯„ä¼°è¿›åº¦:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 28/74 [1:05:59<1:46:25, 138.81s/it]è¯„ä¼°è¿›åº¦:  39%|â–ˆâ–ˆâ–ˆâ–‰      | 29/74 [1:07:50<1:37:49, 130.43s/it]è¯„ä¼°è¿›åº¦:  41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 30/74 [1:10:12<1:38:04, 133.74s/it]è¯„ä¼°è¿›åº¦:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 31/74 [1:12:06<1:31:43, 127.99s/it]è¯„ä¼°è¿›åº¦:  43%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 32/74 [1:14:04<1:27:23, 124.85s/it]è¯„ä¼°è¿›åº¦:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 33/74 [1:16:30<1:29:36, 131.14s/it]è¯„ä¼°è¿›åº¦:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 34/74 [1:19:41<1:39:29, 149.23s/it]è¯„ä¼°è¿›åº¦:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 35/74 [1:21:36<1:30:15, 138.86s/it]è¯„ä¼°è¿›åº¦:  49%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 36/74 [1:23:58<1:28:39, 139.99s/it]è¯„ä¼°è¿›åº¦:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 37/74 [1:25:59<1:22:43, 134.15s/it]è¯„ä¼°è¿›åº¦:  51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 38/74 [1:28:20<1:21:40, 136.13s/it]è¯„ä¼°è¿›åº¦:  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 39/74 [1:30:34<1:19:10, 135.72s/it]è¯„ä¼°è¿›åº¦:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 40/74 [1:32:26<1:12:52, 128.59s/it]è¯„ä¼°è¿›åº¦:  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 41/74 [1:35:45<1:22:20, 149.72s/it]è¯„ä¼°è¿›åº¦:  57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 42/74 [1:39:04<1:27:45, 164.55s/it]è¯„ä¼°è¿›åº¦:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 43/74 [1:41:28<1:21:47, 158.31s/it]è¯„ä¼°è¿›åº¦:  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 44/74 [1:43:59<1:18:00, 156.02s/it]è¯„ä¼°è¿›åº¦:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 45/74 [1:46:44<1:16:44, 158.79s/it]è¯„ä¼°è¿›åº¦:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 46/74 [1:48:57<1:10:28, 151.01s/it]è¯„ä¼°è¿›åº¦:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 47/74 [1:50:38<1:01:11, 135.97s/it]è¯„ä¼°è¿›åº¦:  65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 48/74 [1:52:31<55:53, 128.98s/it]  è¯„ä¼°è¿›åº¦:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 49/74 [1:54:45<54:25, 130.61s/it]è¯„ä¼°è¿›åº¦:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 50/74 [1:56:39<50:16, 125.70s/it]è¯„ä¼°è¿›åº¦:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 51/74 [1:58:50<48:45, 127.18s/it]è¯„ä¼°è¿›åº¦:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 52/74 [2:00:25<43:05, 117.51s/it]è¯„ä¼°è¿›åº¦:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 53/74 [2:03:19<47:03, 134.44s/it]è¯„ä¼°è¿›åº¦:  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 54/74 [2:04:56<41:06, 123.34s/it]è¯„ä¼°è¿›åº¦:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 55/74 [2:07:17<40:41, 128.49s/it]è¯„ä¼°è¿›åº¦:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 56/74 [2:10:02<41:54, 139.70s/it]è¯„ä¼°è¿›åº¦:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 57/74 [2:12:16<39:01, 137.74s/it]è¯„ä¼°è¿›åº¦:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 58/74 [2:14:13<35:04, 131.52s/it]è¯„ä¼°è¿›åº¦:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 59/74 [2:17:30<37:47, 151.18s/it]è¯„ä¼°è¿›åº¦:  81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 60/74 [2:19:28<32:59, 141.38s/it]è¯„ä¼°è¿›åº¦:  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 61/74 [2:21:03<27:34, 127.28s/it]è¯„ä¼°è¿›åº¦:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 62/74 [2:22:55<24:32, 122.68s/it]è¯„ä¼°è¿›åº¦:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 63/74 [2:25:37<24:40, 134.62s/it]è¯„ä¼°è¿›åº¦:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 64/74 [2:27:28<21:13, 127.39s/it]è¯„ä¼°è¿›åº¦:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 65/74 [2:30:47<22:20, 148.92s/it]è¯„ä¼°è¿›åº¦:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 66/74 [2:32:52<18:55, 141.94s/it]è¯„ä¼°è¿›åº¦:  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 67/74 [2:35:46<17:40, 151.48s/it]è¯„ä¼°è¿›åº¦:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 68/74 [2:37:24<13:32, 135.44s/it]è¯„ä¼°è¿›åº¦:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 69/74 [2:40:41<12:49, 153.88s/it]è¯„ä¼°è¿›åº¦:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 70/74 [2:42:51<09:46, 146.68s/it]è¯„ä¼°è¿›åº¦:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 71/74 [2:45:16<07:18, 146.15s/it]è¯„ä¼°è¿›åº¦:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 72/74 [2:48:05<05:06, 153.06s/it]è¯„ä¼°è¿›åº¦:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 73/74 [2:50:40<02:33, 153.66s/it]/media/pc3048/8e92fcae-9dcb-48b7-818b-82c5f8ed050e/software/anaconda3/envs/tjk_ee/lib/python3.10/site-packages/unsloth/kernels/utils.py:970: UserWarning: An output with one or more elements was resized since it had shape [1, 3, 2560], which does not match the required output shape [3, 1, 2560]. This behavior is deprecated, and in a future PyTorch release outputs will not be resized unless they have zero elements. You can explicitly reuse an out tensor t by resizing it, inplace, to zero elements with t.resize_(0). (Triggered internally at /pytorch/aten/src/ATen/native/Resize.cpp:30.)
  out = torch_matmul(X, W, out = out)
è¯„ä¼°è¿›åº¦: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 74/74 [2:51:33<00:00, 123.43s/it]è¯„ä¼°è¿›åº¦: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 74/74 [2:51:33<00:00, 139.10s/it]

============================================================
ğŸ“Š OG-LANS è¯„ä¼°æŠ¥å‘Š
============================================================

ğŸ“ˆ æ ·æœ¬ç»Ÿè®¡
   æ€»æ ·æœ¬æ•°: 1171
   è§£æå¤±è´¥: 8 (0.68%)

ğŸ“ Strict æ¨¡å¼ (å®Œå…¨åŒ¹é…)
   Precision: 0.3985
   Recall:    0.3368
   F1 Score:  0.3651

ğŸ“ Relaxed æ¨¡å¼ (éƒ¨åˆ†åŒ¹é…)
   Precision: 0.6030
   Recall:    0.4857
   F1 Score:  0.5380

ğŸ·ï¸ äº‹ä»¶ç±»å‹è¯†åˆ«
   Type Precision: 0.8305
   Type Recall:    0.8812
   Type F1 Score:  0.8551

âŒ ä¸»è¦é”™è¯¯ç±»å‹ (Top 10)
   FN_è‚¡ä»½å›è´­_å›è´­è‚¡ä»½æ•°é‡: 220
   FN_è‚¡ä»½å›è´­_æ¯è‚¡äº¤æ˜“ä»·æ ¼: 185
   FN_è‚¡ä»½å›è´­_å›è´­å®Œæˆæ—¶é—´: 181
   FP_è‚¡ä»½å›è´­_å›è´­è‚¡ä»½æ•°é‡: 179
   FN_è´¨æŠ¼_è´¨æŠ¼è‚¡ç¥¨/è‚¡ä»½æ•°é‡: 147
   FN_è´¨æŠ¼_è´¨æŠ¼æ–¹: 122
   FN_äºæŸ_è´¢æŠ¥å‘¨æœŸ: 108
   FN_è§£é™¤è´¨æŠ¼_è´¨æŠ¼è‚¡ç¥¨/è‚¡ä»½æ•°é‡: 107
   FN_è´¨æŠ¼_è´¨æŠ¼ç‰©: 107
   FN_è´¨æŠ¼_è´¨æŠ¼ç‰©å æŒè‚¡æ¯”: 107

ğŸ”® é«˜çº§æŒ‡æ ‡
   å¹»è§‰æ ·æœ¬ç‡:      0.2323
   å¹»è§‰å®ä½“ç‡:      0.0631
   CoT å¿ å®åº¦:      1.0000
   CoT ç±»å‹ä¸€è‡´æ€§:  1.0000
   CoT è®ºå…ƒä¸€è‡´æ€§:  1.0000
   Schema ç¬¦åˆç‡(ç±»å‹+è§’è‰²): 0.6900

============================================================

ğŸ’¾ ä¿å­˜ç»“æœ...
   ç»“æœæ–‡ä»¶: logs/DuEE-Fin/eval_academic/20260215_001745_dev/eval_results_dev_seed3407.jsonl
   æŒ‡æ ‡æ–‡ä»¶: logs/DuEE-Fin/eval_academic/20260215_001745_dev/eval_results_dev_seed3407_metrics.json
   æ‘˜è¦æ–‡ä»¶: logs/DuEE-Fin/eval_academic/20260215_001745_dev/eval_results_dev_seed3407_summary.json
   è¿è¡Œæ¸…å•: logs/DuEE-Fin/eval_academic/20260215_001745_dev/run_manifest.json

âœ… è¯„ä¼°å®Œæˆ!
